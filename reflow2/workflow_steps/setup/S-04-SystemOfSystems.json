{
  "workflow_metadata": {
    "version": "0.1.0",
    "name": "Arch-00 System-of-Systems Decomposition",
    "description": "Decompose multiple existing systems to understand their internal structure and identify integration interfaces needed for a target integration goal",
    "purpose": "Handle scenarios where multiple independent systems need to be integrated, requiring analysis of each system's internal structure to determine integration points"
  },
  "entry_conditions": {
    "system_name_known": true,
    "working_directory": "pwd == /path/to/systems/<system_name>",
    "required_inputs": [
      "High-level integration requirements document",
      "Access to individual system repositories/codebases (optional - can be provided during workflow)",
      "List of systems to be integrated"
    ]
  },
  "prerequisites": {
    "required_templates": [
      "./templates/system_decomposition_template.json",
      "./templates/integration_requirements_template.json"
    ],
    "required_tools": [
      "./tools/analyze_system_structure.py",
      "./tools/identify_integration_points.py"
    ]
  },
  "steps": [
    {
      "id": "S0.1",
      "name": "Capture Integration Requirements",
      "description": "Document the high-level integration goals and requirements",
      "tool": "manual",
      "inputs": [
        "High-level integration requirements document",
        "Target integration objectives",
        "Success criteria for integrated system"
      ],
      "outputs": [
        "context/integration_requirements.json"
      ],
      "template": "./templates/integration_requirements_template.json",
      "guidance": [
        "Document what the integrated system should accomplish",
        "Identify key interactions between systems",
        "Define success criteria and constraints",
        "Note any performance, security, or operational requirements"
      ]
    },
    {
      "id": "S0.2", 
      "name": "Enumerate Target Systems",
      "description": "List all systems that need to be integrated and their current state",
      "tool": "manual",
      "inputs": [
        "System inventory",
        "System access information (repositories, documentation, etc.)"
      ],
      "outputs": [
        "context/target_systems_inventory.json"
      ],
      "guidance": [
        "List each system with identifier, purpose, current deployment state",
        "Note available documentation and access methods for each system",
        "Identify system ownership and contact information",
        "Document current interfaces (if any) that each system exposes"
      ]
    },
    {
      "id": "S0.3",
      "name": "System Structure Analysis",
      "description": "For each target system, analyze its internal structure to identify components and capabilities",
      "tool": "manual",
      "iteration": "per_system",
      "inputs": [
        "System codebase or documentation",
        "Existing system architecture (if available)"
      ],
      "outputs": [
        "specs/machine/decomposition/<system_id>/system_structure.json"
      ],
      "template": "./templates/system_decomposition_template.json",
      "guidance": [
        "Identify major functional modules/components within the system",
        "Map component responsibilities and capabilities", 
        "Document internal interfaces between components",
        "Note external dependencies and current interface points",
        "Classify components by architectural layer (e.g., presentation, business logic, data)",
        "Identify potential integration points (APIs, data interfaces, event systems)"
      ],
      "generic_approach": {
        "description": "This analysis should be system-type agnostic",
        "levels": {
          "system_level": "The entire system being analyzed",
          "subsystem_level": "Major functional groups within the system",
          "component_level": "Individual functional units that could be integration points"
        },
        "analysis_dimensions": [
          "Functional responsibilities",
          "Data inputs and outputs", 
          "External interaction points",
          "Internal communication mechanisms",
          "Resource dependencies",
          "Operational characteristics"
        ]
      }
    },
    {
      "id": "S0.4",
      "name": "Cross-System Interface Analysis", 
      "description": "Analyze integration requirements against system structures to identify needed interfaces",
      "tool": "manual",
      "inputs": [
        "context/integration_requirements.json",
        "All system_structure.json files",
        "Current interface capabilities"
      ],
      "outputs": [
        "specs/machine/integration_analysis.json"
      ],
      "guidance": [
        "Map integration requirements to specific system components",
        "Identify where new interfaces need to be created",
        "Identify where existing interfaces need modification",
        "Document data flow requirements between systems",
        "Note synchronization and consistency requirements",
        "Identify potential integration patterns (API calls, messaging, shared data)"
      ]
    },
    {
      "id": "S0.5",
      "name": "Integration Impact Assessment",
      "description": "Assess what changes are needed in each system to support integration",
      "tool": "manual", 
      "inputs": [
        "specs/machine/integration_analysis.json",
        "All system_structure.json files"
      ],
      "outputs": [
        "specs/machine/integration_impact_assessment.json"
      ],
      "guidance": [
        "For each system, identify components that need modification",
        "Specify new interfaces that need to be implemented",
        "Document changes to existing interfaces",
        "Identify new components that may need to be created",
        "Assess complexity and risk of required changes",
        "Prioritize changes by importance and difficulty"
      ]
    },
    {
      "id": "S0.6",
      "name": "Generate Unified System Architecture",
      "description": "Create an integrated system architecture that incorporates all analyzed systems",
      "tool": "manual",
      "inputs": [
        "All system decomposition artifacts",
        "Integration analysis and impact assessment"
      ],
      "outputs": [
        "specs/machine/unified_system_architecture.json"
      ],
      "guidance": [
        "Create a unified view of all systems as components of the integrated system",
        "Define the integration interfaces between systems",
        "Specify the overall system architecture patterns",
        "Document the unified system's external interfaces",
        "Prepare input for standard architecture workflow (Arch-01 onward)"
      ]
    }
  ],
  "validation": {
    "completeness_checks": [
      "All target systems have been analyzed",
      "Integration requirements are mapped to system components",
      "Impact assessment covers all affected systems",
      "Unified architecture is consistent with individual system structures"
    ],
    "consistency_checks": [
      "Interface requirements are bidirectionally consistent",
      "Data flow requirements are achievable",
      "No circular dependencies introduced",
      "Integration patterns are appropriate for system types"
    ]
  },
  "artifact_routing": {
    "integration_requirements": "context/integration_requirements.json",
    "systems_inventory": "context/target_systems_inventory.json", 
    "system_structures": "specs/machine/decomposition/<system_id>/system_structure.json",
    "integration_analysis": "specs/machine/integration_analysis.json",
    "impact_assessment": "specs/machine/integration_impact_assessment.json",
    "unified_architecture": "specs/machine/unified_system_architecture.json"
  },
  "handoff": {
    "to": "architecture/Arch-01-SetupAndContext.json",
    "provides": [
      "Comprehensive understanding of all systems to be integrated",
      "Specific interface requirements between systems", 
      "Impact assessment for each system",
      "Unified system architecture as input to standard architecture workflow"
    ],
    "context_preparation": {
      "working_memory_updates": [
        "Add decomposed system structures to working memory",
        "Include integration requirements and constraints",
        "Note which systems require modifications"
      ],
      "current_focus_updates": [
        "Shift focus from decomposition to unified architecture design",
        "Prepare for standard architecture workflow with integration context"
      ]
    }
  },
  "iteration_paths": {
    "on_incomplete_system_analysis": "S0.3",
    "on_integration_conflicts": "S0.4", 
    "on_impact_assessment_issues": "S0.5",
    "on_architecture_inconsistency": "S0.6"
  },
  "usage_patterns": {
    "system_of_systems_integration": {
      "description": "Primary use case - integrating multiple independent systems",
      "typical_systems": [
        "Microservices that need orchestration",
        "Independent applications requiring data sharing",
        "Legacy systems requiring modernization and integration",
        "Distributed components requiring centralized coordination"
      ]
    },
    "brownfield_development": {
      "description": "Adding new capabilities to existing system ecosystem",
      "approach": "Analyze existing systems, design new system to integrate cleanly"
    },
    "migration_projects": {
      "description": "Moving from multiple systems to unified architecture",
      "approach": "Understand current state, design target state, plan migration path"
    }
  }
}