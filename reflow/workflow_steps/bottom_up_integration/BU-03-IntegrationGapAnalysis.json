{
  "workflow_metadata": {
    "version": "1.0.0",
    "name": "BU-03 Integration Gap Analysis",
    "description": "Identify integration gaps - missing interfaces, protocol mismatches, data model incompatibilities, etc."
  },
  "entry_conditions": {
    "from": "BU-02-IntegrationRequirements",
    "artifacts": [
      "specs/machine/component_inventory.json",
      "specs/machine/integration_requirements.json"
    ]
  },
  "steps": [
    {
      "id": "BU-03.1",
      "name": "Run Integration Gap Analysis Tool",
      "description": "Analyze inventory + requirements to identify gaps",
      "tool": "{reflow_root}/tools/analyze_integration_gaps.py",
      "command": "python3 {reflow_root}/tools/analyze_integration_gaps.py --inventory {system_root}/specs/machine/component_inventory.json --requirements {system_root}/specs/machine/integration_requirements.json --output {system_root}/specs/machine/integration_gaps.json",
      "gap_types_detected": [
        "missing_interface",
        "protocol_mismatch",
        "data_model_incompatibility",
        "missing_mediator",
        "circular_dependency",
        "conflicting_requirements",
        "version_incompatibility",
        "performance_gap",
        "security_gap"
      ]
    },
    {
      "id": "BU-03.2",
      "name": "Review and Classify Gaps",
      "description": "Review detected gaps, assign severity and priority",
      "tool": "manual",
      "outputs": ["Gaps classified by severity (critical/high/medium/low)"]
    },
    {
      "id": "BU-03.3",
      "name": "Recommend Solutions for Each Gap",
      "description": "For each gap, propose solution approach (create adapter, modify component, refactor, etc.)",
      "tool": "manual",
      "solution_types": [
        "modify_component",
        "create_adapter",
        "create_mediator",
        "refactor_architecture",
        "use_existing_pattern"
      ],
      "outputs": ["Recommended solutions with effort estimates"]
    },
    {
      "id": "BU-03.4",
      "name": "Create Resolution Roadmap",
      "description": "Organize gaps into phases for resolution",
      "tool": "manual",
      "outputs": ["Phased resolution roadmap"]
    },
    {
      "id": "BU-03.5",
      "name": "Finalize integration_gaps.json",
      "tool": "manual",
      "template": "{reflow_root}/templates/integration_gaps_template.json",
      "output_path": "{system_root}/specs/machine/integration_gaps.json"
    }
  ],
  "validation": {
    "checks": [
      "All critical gaps have recommended solutions",
      "Resolution roadmap is complete",
      "Gap severity aligns with impact analysis",
      "Estimated total effort is reasonable"
    ]
  },
  "handoff": {
    "produces": ["specs/machine/integration_gaps.json"],
    "next_workflow": "BU-04-ComponentDeltaAnalysis.json"
  },
  "llm_agent_guidance": {
    "critical_reminders": [
      "analyze_integration_gaps.py automates gap detection - DO NOT skip running this tool",
      "Critical gaps MUST be resolved before integration can proceed",
      "Protocol mismatches often require adapter components",
      "Circular dependencies require architectural refactoring - cannot be solved with adapters"
    ]
  }
}
